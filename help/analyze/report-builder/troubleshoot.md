---
description: Report Builder 提交的优化方式及有时可能出现的错误消息的列表。
title: Report Builder 疑难解答和最佳实践
topic: Report builder
uuid: 36a08143-dc78-40f5-9ce9-7d16980aa27b
translation-type: tm+mt
source-git-commit: dabaf6247695bc4f3d9bfe668f3ccfca12a52269

---


# Report Builder 疑难解答和最佳实践

Report Builder 提交的优化方式及有时可能出现的错误消息的列表。

## Report Builder 5.0 用户和打开 5.1 工作簿 {#section_C29898775999453FABB5FB0E098415C8}

Adobe将维度和分类之间的分隔符从下划线字符(_)更改为||. 此更改对于打开包含分类请求的Report Builder v5.1工作簿的Report Builder 5.0用户具有兼容性影响。 每次打开v5.1以前版本的工作簿时，其所有序列化分类请求都将转换为此格式。

这引入了一个前向兼容性问题：转换为v5.1后，如果在Report Builder v5.0上与用户共享工作簿，则该用户将无法识别分类请求（事实上，该用户正在查找“_”，但v5.1序列化“||”）。

在打开具有分类请求的 ARB v5.1 工作簿时，您会体验到以下不良影响：

* 打开该工作簿时，会收到以下警告：“本工作簿上次是使用 Report Builder v5.1 保存的。此版本的某些功能与安装在这台计算机上的 Report Builder 版本不兼容。我们强烈建议您在更新此工作簿之前，升级到最新的 Report Builder 版本。”
* 如果右键单击包含分类的ARB请求，则不会显示Report Builder上下文菜单（编辑请求、添加从属请求……）。
* 如果执行“全部刷新”(Refresh All)，通过单击第三个按钮，或通过从请求管理器表单刷新一组请求，分类请求将无错误地执行。 但是，不会写出分类值。
* 您仍然可以通过打开请求管理器来编辑请求，然后逐行转到正确的请求。
* 如果编辑请求并保留所有参数不变，然后单击“完成”，则将正确写出响应。 事实上，编辑请求可解决响应布局参数重新序列化时的问题。 因此，有一种解决办法，尽管这很费时。

## Report Builder 中的身份验证问题 {#section_FD79104DF1414FE2B36591606C963DE6}

Report Builder 需要进行身份验证，才能从报表包创建数据请求。有时在登录 Report Builder 时会出现问题，具体取决于 [!DNL Analytics] 或您网络内的设置。

**登录公司无效**

当登录公司输入错误或网络活动问题时，最常出现此错误。 执行以下操作：

* 检查登录公司拼写，以确保没有打字错误或错误的空格。
* 使用相同的登录公司登录 Analytics，以确保不会出现任何差错。如果您无法使用这些凭据进行登录，请联系您所在组织的任一管理员，以获取正确的登录公司。

**防火墙**

Report Builder使用端口80和443。 确保允许这些端口通过组织的防火墙。 另请参阅Adobe的内部IP地址以了解其他防火墙排除。

## 优化请求的建议 {#section_33EF919255BF46CD97105D8ACB43573F}

以下因素可能会增加请求的复杂性和导致处理缓慢：

**可能会降低提交速度的因素**

* 几小时内计划的书签、仪表板和Report Builder工作簿过多
* 同时计划的Report Builder工作簿过多。 如果出现这种情况，报表 API 队列会形成积压。

**可能降低工作簿运行时速度的因素**

* 分类显着增加。
* 随时间递增请求日期范围。

   **示例**：假定您使用“当前年份”设置创建一个趋势请求，按“日”粒度进行划分。年终时，该请求返回的时段将多于年初创建时的时段。

   `(January 1 - January 30 versus January 1 - December 31.)`

**导致工作簿提交失败的原因**

工作簿中包含复杂的 Excel 公式，特别是涉及日期和时间的公式。

**单元格返回 0（没有值）**

Excel工作表名称中的撇号或单引号将导致报表生成器不返回任何值。 （这是Microsoft Excel的限制。）

**单个请求性能**

处理速度可能受以下设置的影响：

| 设置 | 更快的性能 | 性能更慢 |
|--- |--- |--- |
| 细分和细分顺序 | 少数 | 许多 |
|  | 示例：如果按照 Z 来划分 A，A 的项目数应始终少于 Z 的项目数。否则，请求时间会显著增加。 |
| Date range | 小范围 | 宽范围 |
| 过滤 | 特定过滤 | 最受欢迎的过滤 |
| 粒度 | 汇总 | 每小时<ul><li>每日</li><li>每周</li><li>每月</li><li>每季</li><li>每年</li></ul> |
| 条目数 | 小数据集 | 大型数据集 |


**计划时间**

在 24 小时内交错执行计划（请参阅下表）。将现有书签、仪表板和Report Builder工作簿安排在一起可能会导致延迟。

计划更大、更复杂的要求，允许在工作日进行手动拉取和刷新。

| 计划时间 | 凌晨1点-凌晨2点 | 凌晨2点-清晨7点 | 上午7点-下午6时 | 下午6点-午夜 |
|--- |--- |--- |--- |--- |
| Report Builder使用情况 | 安静 | 非常忙 | 客户端使用。<br>大量用户在本地进行刷新，并请求“立即发送”。<br>此外，验证在计划工作簿超时时，API 队列是否清除。 | 不忙 |

**超时**

任何计划的报告都会在四小时后超时。 系统尝试再安排三次，这可能导致失败。 （通常，数据集越大，运行时间越长。）这些超时可在 [!DNL Analytics] 报告和 Report Builder 中查看：

* [!DNL Analytics]: **[!UICONTROL Favorites]** > **[!UICONTROL Scheduled Reports]**

* Report Builder: Click **[!UICONTROL Management]** in the [!UICONTROL Add-ins] tab in Excel.

## 错误消息说明 {#section_3DF3A1EEDAD149CB941BEABEF948A4A5}

使用 Report Builder 过程中有时会显示的错误消息列表。

>[!NOTE] 这只是一部分错误消息，并不是详尽列表。要了解有关解决错误的更多信息，请与您的管理员联系。

**此功能只能应用于打开的工作簿。**

如果Excel中未打开任何工作簿(电子表格文档)，并且单击报表生成器工具栏中的某个图标，则会显示此消息。 此外，在打开电子表格之前，工具栏会被禁用。 但是，在工具栏仍处于启用状态时，您可以单击联机帮助图标，但不会导致此错误。

**在激活之前，您首[!UICONTROL Request Wizard]先需要退出[!UICONTROL Request Manager]。**

虽然在功 [!UICONTROL Request Manager] 能上链接 [!UICONTROL Request Wizard] 了这些组件，但在完成或取消在中执行的操作之前，不能 [!UICONTROL Request Manager] 开始与它们一起使用 [!UICONTROL Request Wizard]。

**没有与此范围关联的请求。**

当电子表格的单元格不包含请 [!UICONTROL From Sheet] 求时，单击 [!UICONTROL Request Manager] 中的按钮会出现此错误消息。

要确定电子表格中包含请求的单元格，请单击表格中列出的各个请求 [!UICONTROL Request Manager]。 如果请求与单元格关联，则在表中选择请求时，单元格将高亮显示。

**选择范围无效。请选择其他范围。**

如果选择了电子表格的某个单元格，并且已将请求映射到该单元格，则会发生此错误。 删除映射到单元格的请求或选择要映射的其他单元格范围。

当您要删除单元格时，请务必在删除单元格（删除行或列）之前找到包含请求的单元格并删除请求。

**在使用此功能之前，请先退出具有焦点的 Excel 单元格。**

如果您处于Excel单 *元格的编辑模式* ，并单击其中一个Report Builder图标，则会显示此错误消息。 Excel单元格中的编辑模式表示已选择该单元格，光标显示在单元格内。 在Excel顶部的栏或栏中直接键入时，您也 [!UICONTROL Formula] 处于Excel单 [!UICONTROL Name Box] 元格的编辑模式。

**选定范围与另一个请求的范围相交。请修改您的选择。**

如果已将一组单元格映射到电子表格，则会显示此错误。

在添加新请求之前确定映射的单元格的一种方法是关闭并 [!UICONTROL Request Wizard] 打开该单元格 [!UICONTROL Request Manager]。 然后，逐个选择请求摘要表中列出的项目。 每当您在列表中选择请求时，电子表格中包含请求映射的相应单元格都会高亮显示。

这是在将多个单元格映射到多个区域之前，您应考虑使用高亮显示、行或列信息或格式样式标记单元格的原因之一。
