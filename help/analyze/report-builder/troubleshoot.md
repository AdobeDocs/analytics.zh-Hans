---
description: 了解如何优化Report Builder交付以及可能发生的错误消息列表。
title: Report Builder 疑难解答和最佳实践
uuid: 36a08143-dc78-40f5-9ce9-7d16980aa27b
feature: Report Builder
role: User, Admin
exl-id: 41a640ce-2316-439b-b3ba-f0bace9af268
source-git-commit: d218d07ec16e981d7e148092b91fbbd5711e840f
workflow-type: tm+mt
source-wordcount: '1410'
ht-degree: 88%

---

# Report Builder 疑难解答和最佳实践

本文介绍了可用于优化Report Builder的故障排除和最佳实践。 它还包含可能显示的错误消息列表。

## Report Builder 5.0 用户和打开的 5.1 工作簿 {#section_C29898775999453FABB5FB0E098415C8}

Adobe 将维度与分类之间的分隔符从下划线字符 (_) 改为 ||。此项更改旨在解决有分类请求的 Report Builder 5.0 用户在打开 Report Builder 5.1 版工作簿时的兼容性问题。每次从 v5.1 之前的版本打开工作簿时，所有序列化的分类请求都将转换为此格式。

这就产生了向前兼容性问题：一旦转换为 v5.1，如果与使用 Report Builder v5.0 的用户共享工作簿，那么该用户将无法识别分类请求（实际上，它一直在查找“_”，然而 v5.1 已将其序列化为“||”）。

在打开具有分类请求的 ARB v5.1 工作簿时，您会体验到以下不良影响：

* 打开该工作簿时，会收到以下警告：“本工作簿上次是使用 Report Builder v5.1 保存的。此版本的某些功能与安装在这台计算机上的 Report Builder 版本不兼容。我们强烈建议您在更新此工作簿之前，升级到最新的 Report Builder 版本。”
* 如果右键单击带有分类的 ARB 请求，并不会出现 Report Builder 上下文菜单（编辑请求、添加从属请求...）。
* 如果通过单击第三个按钮或通过刷新请求管理器表单中的一系列请求来执行“全部刷新”操作，则可以成功执行分类请求。然而却无法写出分类值。
* 您还可以通过打开请求管理器来编辑请求，然后逐行检查，直到成为正确的请求。
* 如果您编辑请求并保持所有参数相同，那么在单击“完成”后，将可以正常写出响应。事实上，编辑请求的这种方法可以解决问题，因为响应布局参数会重新进行序列化。所以说还是有解决方案的，只是这种方案过于费时。

## Report Builder 中的身份验证问题 {#section_FD79104DF1414FE2B36591606C963DE6}

Report Builder 需要进行身份验证，才能从报表包创建数据请求。有时在登录到Report Builder时会出现问题，具体取决于您在中的设置 [!DNL Analytics] 或您的网络。

* **登录公司无效**：此错误通常出现在登录公司未正确输入或存在网络活动问题时。 执行以下操作：
   * 检查登录公司的拼写，以确保没有打错字或出现错误的空格。
   * 使用相同的登录公司登录 Analytics，以确保不会出现任何差错。如果您无法使用这些凭据进行登录，请联系您所在组织的任一管理员，以获取正确的登录公司。
* **防火墙**：Report Builder 使用端口 80 和 443。确保您所在组织的防火墙允许这些端口通过。有关其他防火墙排除项，还可以参阅“Adobe 的内部 IP 地址”。

## 优化请求的建议 {#section_33EF919255BF46CD97105D8ACB43573F}

以下因素会增加请求复杂性并导致处理速度变慢。

* **可能会降低传递速度的因素**：在数个小时内安排了太多的书签、功能板和 Report Builder 工作簿。此外还要考虑在相同时间附近安排了太多 Report Builder 工作簿。如果出现这种情况，报表 API 队列会形成积压。
* **可能降低工作簿运行时速度的因素**：显著增加了分类，或者减少了一段时间内请求的日期范围。
* **导致工作簿传递失败的原因**：工作簿中复杂的 Excel 公式，特别是设计日期和时间的公式。
* **单元格返回0（没有值）**：Excel工作表中的撇号或单引号会导致Report Builder不返回任何值。 （这是由于 Microsoft Excel 自身存在的限制所致。）
* **单个请求性能**：处理速度可能会受以下设置影响：

  | 设置 | 性能提高 | 性能降低 |
  |--- |--- |--- |
  | 划分和划分顺序 | 较少 | 较多 |
  |  | 示例：如果按照 Z 来划分 A，A 的项目数应始终少于 Z 的项目数。否则，请求时间会显著增加。 |
  | 日期范围 | 小范围 | 大范围 |
  | 正在筛选 | 特定筛选 | 最受欢迎的过滤设置 |
  | 粒度 | 汇总 | 每小时<ul><li>每日</li><li>每周</li><li>每月</li><li>每季</li><li>每年</li></ul> |
  | 条目数 | 小型数据集 | 大型数据集 |

* **计划时间**：在 24 小时的周期内计划错开的时间（参见下表）。如果现有书签、功能板和 Report Builder 工作簿安排得过于密集，可能会导致延迟。复杂性较高的大型请求应安排在清晨运行，允许在工作时间内进行手动提取和刷新。

  | 计划时间 | 凌晨 1 点 - 凌晨 2 点 | 凌晨 2 点 - 上午 7 点 | 上午 7 点 - 下午 6 点 | 下午 6 点 - 午夜 |
  |--- |--- |--- |--- |--- |
  | Report Builder 使用情况 | 安静 | 非常繁忙 | 客户端使用情况。<br>大量用户在本地进行刷新，并请求“立即发送”。<br>此外，验证在计划工作簿超时时，API 队列是否清除。 | 不忙 |

* **超时**：任意计划报表在四小时后超时。系统再尝试计划 3 次，这可能会导致失败。（一般而言，数据集越大，所用的运行时间越长。）这些超时可在 [!DNL Analytics] 报告和 Report Builder 中查看：

## 示例错误消息说明 {#section_3DF3A1EEDAD149CB941BEABEF948A4A5}

本节包含使用Report Builder时可能发生的错误消息的示例列表。

>[!NOTE]
>
>这是错误消息的示例，而不是详尽列表。 要了解有关解决错误的更多信息，请与您的管理员联系。

* **此功能只能应用于打开的工作簿。**：如果未在Excel中打开任何工作簿（电子表格文档），并且您单击了Report Builder工具栏中的图标之一，则会显示此消息。 另外还会禁用工具栏，直到您打开电子表格为止。然而，您可以在工具栏仍处于启用状态时单击在线帮助图标，这不会导致此错误。
* **您需要先退出[!UICONTROL 请求向导]，才能激活[!UICONTROL 请求管理器]。**：虽然[!UICONTROL 请求管理器]和[!UICONTROL 请求向导]在功能上有关联，但必须先完成或取消在[!UICONTROL 请求向导]中采取的操作，然后才能开始使用[!UICONTROL 请求管理器]。
* **没有与此范围关联的请求。**：当电子表格的单元格中不包含请求时，如果您在[!UICONTROL 请求管理器]中单击[!UICONTROL 从工作表]按钮，则会出现此错误消息。要确定电子表格中的哪些单元格包含请求，请单击[!UICONTROL 请求管理器]的表中列出的各个请求。如果某一请求与单元格相关联，那么在表中选择该请求后，会突出显示这些单元格。
* **选择范围无效。请选择其他范围。**：如果选择了电子表格的某个单元格并且已有请求映射到其上，则会出现此错误。删除映射到单元格的请求，或者选择另一单元格范围进行映射。要删除单元格时，请务必找到包含请求的单元格，先删除请求，然后再删除单元格（删除行或列）。
* **在使用此功能之前，请先退出具有焦点的 Excel 单元格。**：如果您在处于 Excel 单元格的&#x200B;*编辑模式*&#x200B;时单击了某个 Report Builder 图标，则会显示此错误消息。Excel 单元格的编辑模式是指选定了单元格，并且光标显示在单元格内。直接在 Excel 顶部的“[!UICONTROL 编辑栏]”或“[!UICONTROL 名称框]”中键入内容时，Excel 单元格也处于编辑模式。
* **选定范围与另一个请求的范围相交。请修改您的选择。**：如果您已映射了一组单元格到电子表格，则会显示此错误。
* **对工作簿的修复（从 /xl/calcChain.xml 部分删除了“记录：公式”）**：在保存或传输时，有时候工作簿的公式会损坏。在打开文件时，Excel 将尝试运行这些公式，然后会失败。通过从电子表格中删除 `calcChain.xml`，强制 Excel 刷新其公式计算即可解决此问题。
   1. 将工作簿的文件扩展名从 `.xlsx` 重命名为 `.zip`。
   2. 解压缩内容并打开 `/xl/` 文件夹。
   3. 删除 `calcChain.xml`。
   4. 重新压缩内容，然后将文件扩展名改回 `.xlsx`。
   5. 在 Excel 中打开工作表，然后刷新所有 Report Builder 请求。
* **与输入过滤器或输出范围关联的 Excel 单元格可能已删除**：Report Builder 使用 Excel 名称来将数据请求附加到单元格。如果您从 Names Manager 中删除了 Excel 名称，则会看到此错误。删除 Excel 名称之后就无法恢复请求。如果安排了工作表，您可从 Scheduling Manager 中下载副本，或者打开以前传递的工作表副本。
