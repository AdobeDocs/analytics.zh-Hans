---
description: 您可以通过锁定工作簿来保护工作簿中的所有请求免受添加和编辑请求的影响。 这通过暂停所有报告请求以提高编辑效率，实现工作簿的脱机编辑。
title: 锁定/解锁工作簿
topic: Report builder
uuid: ef5c276c-5f74-4741-b6fa-4c79eda29f62
translation-type: tm+mt
source-git-commit: dabaf6247695bc4f3d9bfe668f3ccfca12a52269

---


# 锁定/解锁工作簿

您可以通过锁定工作簿来保护工作簿中的所有请求免受添加和编辑请求的影响。 这通过暂停所有报告请求以提高编辑效率，实现工作簿的脱机编辑。

作为分析师，锁定工作簿可让您保护工作簿请求免受组织内其他用户的篡改。 同时，这些用户仍可刷新工作簿中的请求。

To protect a workbook against editing, click **[!UICONTROL Locked]** on the Report Builder toolbar ( ![](assets/locked_icon.png)

)。

To unprotect a workbook, click **[!UICONTROL Unlocked]** ( ![](assets/unlocked_icon.png)

)。

如果您具有以下权限之一，则可以解锁已锁定的工作簿：

* 您是管理员，或
* 您是最初锁定工作簿的人。 在这种情况下，您不必是管理员。

>[!NOTE] 除非您具有解锁工作簿的权限，否则您无法向受保护的工作簿中添加请求。

当工作簿被锁定以禁止请求编辑时，

* 用户无法创建／添加请求。
* 用户无法通过请求向导编辑请求。
* 用户无法通过“编辑多个请求”功能编辑请求。
* 用户无法剪切、复制或粘贴请求。 但是，用户仍可以使用本机Excel剪切／复制／粘贴上下文菜单来剪切／复制／粘贴请求的内容。
* 用户可以单独刷新请求，也可以作为组的一部分刷新请求。
* 如果请求使用单元格(日期范围、段、过滤器)的输入值，则用户可以更改单元格中的这些值，从而通过刷新请求间接编辑这些值。

如果尝试编辑受保护的工作簿(通过上下文菜单或 **[!UICONTROL Request Manager]**&#x200B;或 **[!UICONTROL Edit Multiple Requests]**)，则可能允许您或不允许您这样做：

* 如果您没有解锁请求的权限，则会显示此提示：

   ![](assets/locked_workbook_error.png)

* 如果您具有所需的权限，则不会显示提示，您可以编辑请求。

## 工作流 {#section_260D05FF632B41DB97DB43E2ADBE2E75}

我们假定工作簿 A 具有一个请求，该工作簿处于锁定状态，且由用户 A 创建。

**示例 1：管理员用户（或用户 A）**

1. 用户登录到 Report Builder 并打开工作簿 
1. 工作簿 A 当前已锁定，因此“创建请求”按钮在工具栏中处于停用状态，且所有其他按钮的功能均因锁定而被禁用。
1. 如果用户尝试使用其中一个已取消激活的按钮，将显示一条消息，指出工作簿当前已锁定。
1. 用户可以解锁工作簿，该工作簿启用了完整的编辑功能。
1. 解锁后，工作簿将保持解锁状态，直到明确重新锁定。

**示例 2：非管理员用户（用户 B）**

1. 用户登录到 Report Builder 并打开工作簿 
1. 用户无法添加／编辑请求。
1. 用户无法解锁工作簿。

