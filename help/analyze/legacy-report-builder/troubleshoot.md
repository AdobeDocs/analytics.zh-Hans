---
description: 了解如何优化Report Builder交付以及可能发生的错误消息列表。
title: Report Builder 疑难解答和最佳实践
uuid: 36a08143-dc78-40f5-9ce9-7d16980aa27b
feature: Report Builder
role: User, Admin
exl-id: 41a640ce-2316-439b-b3ba-f0bace9af268
source-git-commit: ca84a5f807545d7196e2e0e90d3209c32d3fd789
workflow-type: tm+mt
source-wordcount: '1424'
ht-degree: 54%

---

# Report Builder 疑难解答和最佳实践

{{legacy-arb}}

本文介绍了可用于优化Report Builder的故障排除和最佳实践。 它还包含可能显示的错误消息列表。

## Report Builder 5.0 用户和打开的 5.1 工作簿 {#section_C29898775999453FABB5FB0E098415C8}

Adobe将维度和分类之间的分隔符从下划线字符(_)更改为 ||。 对于打开具有分类请求的Report Builder v5.1工作簿的Report Builder 5.0用户，此更改具有兼容性含义。 每次打开版本低于v5.1的工作簿时，其所有序列化分类请求都将转换为此格式。

这会造成向前兼容问题：转换为v5.1后，如果将工作簿与Report Builder v5.0上的用户共享，该用户将无法识别分类请求（事实上，它会查找&quot;_&quot;而非v5.1序列化&quot;||&quot;）。

在打开具有分类请求的 ARB v5.1 工作簿时，您会体验到以下不良影响：

* 打开该工作簿时，会收到以下警告：“本工作簿上次是使用 Report Builder v5.1 保存的。此版本的某些功能与安装在这台计算机上的 Report Builder 版本不兼容。我们强烈建议您在更新此工作簿之前，升级到最新的 Report Builder 版本。”
* 如果右键单击分类的ARB请求，将不会显示Report Builder上下文菜单（编辑请求、添加从属请求……）。
* 如果通过单击第三个按钮或从“请求管理器”表单中刷新一组请求来执行全部刷新，则分类请求将在没有错误的情况下执行。 但是，不会写出分类值。
* 您仍然可以通过打开请求管理器，然后逐行编辑，直到到达正确的请求为止。
* 如果您编辑请求并保留所有参数不变，然后单击“完成”，则将正确写出响应。 事实上，编辑请求解决了问题，因为响应布局参数已重新序列化。 虽然这很耗时，但还是有变通办法。

## Report Builder 中的身份验证问题 {#section_FD79104DF1414FE2B36591606C963DE6}

Report Builder 需要进行身份验证，才能从报表包创建数据请求。有时在登录Report Builder时会出现问题，具体取决于[!DNL Analytics]或您网络内的设置。

* **无效的登录公司**：此错误最常见于登录公司输入不正确或存在网络活动问题时。 执行以下操作：
   * 检查登录公司的拼写，确保没有拼写错误或空格错误。
   * 使用相同的登录公司登录 Analytics，以确保不会出现任何差错。如果您无法使用这些凭据进行登录，请联系您所在组织的任一管理员，以获取正确的登录公司。
* **防火墙**： Report Builder使用端口80和443。 确保允许这些端口通过贵组织的防火墙。 另请参阅Adobe的内部IP地址，以获取其他防火墙排除项。

## 优化请求的建议 {#section_33EF919255BF46CD97105D8ACB43573F}

以下因素会增加请求复杂性并导致处理速度变慢。

* **可能会降低传递速度的因素**：在数个小时内安排了太多的书签、功能板和 Report Builder 工作簿。此外还要考虑在相同时间附近安排了太多 Report Builder 工作簿。如果出现这种情况，报表 API 队列会形成积压。
* **可能会降低工作簿运行时速度的因素**：分类显着增加，或者请求日期范围会随着时间而增加。
* **导致工作簿传递失败的原因**：工作簿中复杂的 Excel 公式，特别是设计日期和时间的公式。
* **单元格返回0（没有值）**： Excel工作表中的撇号或单引号将导致Report Builder不返回任何值。 （这是由于 Microsoft Excel 自身存在的限制所致。）
* **单个请求性能**：处理速度可能会受以下设置影响：

  | 设置 | 更快的性能 | 较慢的性能 |
  |--- |--- |--- |
  | 划分和划分顺序 | 少数 | 许多 |
  |  | 示例：如果按照 Z 来划分 A，A 的项目数应始终少于 Z 的项目数。否则，请求时间会显著增加。 |  |
  | 日期范围 | 小范围 | 宽范围 |
  | 筛选 | 特定筛选 | 最受欢迎的过滤设置 |
  | 粒度 | 汇总 | 每小时<ul><li>每日</li><li>每周</li><li>每月</li><li>每季</li><li>每年</li></ul> |
  | 条目数 | 小型数据集 | 大型数据集 |

* **计划时间**：在 24 小时的周期内计划错开的时间（参见下表）。如果现有书签、功能板和 Report Builder 工作簿安排得过于密集，可能会导致延迟。将更大、更复杂的请求安排在清晨，以便在工作日进行手动提取和刷新。

  | 计划时间 | 凌晨1点 — 凌晨2点 | 凌晨2时至7时 | 上午7时至下午6时 | 下午6点 — 午夜 |
  |--- |--- |--- |--- |--- |
  | Report Builder使用情况 | 安静 | 非常忙 | 客户端使用。<br>大量用户在本地进行刷新，并请求“立即发送”。<br>此外，验证在计划工作簿超时时，API 队列是否清除。 | 不忙 |

* **超时**：任何计划报告在四小时后超时。 系统会再尝试计划三次，这可能会导致失败。 （通常，数据集越大，运行所需的时间越长。） 这些超时可在[!DNL Analytics]报表和Report Builder中查看：

## 示例错误消息说明 {#section_3DF3A1EEDAD149CB941BEABEF948A4A5}

此部分包含使用Report Builder时可能发生的错误消息的示例列表。

>[!NOTE]
>
>这是错误消息的示例，而不是详尽列表。 要了解有关解决错误的更多信息，请与您的管理员联系。

* **此功能只能应用于打开的工作簿。**：如果未在Excel中打开任何工作簿（电子表格文档），并且您单击了Report Builder工具栏中的图标之一，则会显示此消息。 此外，在打开电子表格之前，工具栏将处于禁用状态。 但是，您可以在工具栏仍处于启用状态时单击联机帮助图标，而不会导致此错误。
* **您需要先退出[!UICONTROL 请求向导]，才能激活[!UICONTROL 请求管理器]。**：虽然[!UICONTROL 请求管理器]和[!UICONTROL 请求向导]在功能上有关联，但必须先完成或取消在[!UICONTROL 请求向导]中采取的操作，然后才能开始使用[!UICONTROL 请求管理器]。
* **没有与此范围关联的请求。**：当电子表格的单元格中不包含请求时，如果您在[!UICONTROL 请求管理器]中单击[!UICONTROL 从工作表]按钮，则会出现此错误消息。要确定电子表格中的哪些单元格包含请求，请在[!UICONTROL 请求管理器]中单击表中列出的各个请求。 如果某一请求与单元格相关联，那么在表中选择该请求后，会突出显示这些单元格。
* **选择范围无效。请选择其他范围。**：如果选择了电子表格的某个单元格并且已有请求映射到其上，则会出现此错误。删除映射到单元格的请求，或者选择另一单元格范围进行映射。要删除单元格时，请务必找到包含请求的单元格，先删除请求，然后再删除单元格（删除行或列）。
* **在使用此功能之前，请先退出具有焦点的 Excel 单元格。**：如果您在处于 Excel 单元格的&#x200B;*编辑模式*&#x200B;时单击了某个 Report Builder 图标，则会显示此错误消息。Excel 单元格的编辑模式是指选定了单元格，并且光标显示在单元格内。直接在Excel顶部的[!UICONTROL 公式]栏或[!UICONTROL 名称框]中键入内容时，Excel单元格也处于编辑模式。
* **选定范围与另一个请求的范围相交。请修改您的选择。**：如果您已映射了一组单元格到电子表格，则会显示此错误。
* **对工作簿的修复（从 /xl/calcChain.xml 部分删除了“记录：公式”）**：在保存或传输时，有时候工作簿的公式会损坏。在打开文件时，Excel 将尝试运行这些公式，然后会失败。通过从电子表格中删除 `calcChain.xml`，强制 Excel 刷新其公式计算即可解决此问题。
   1. 将工作簿的文件扩展名从 `.xlsx` 重命名为 `.zip`。
   2. 解压缩内容并打开 `/xl/` 文件夹。
   3. 删除 `calcChain.xml`。
   4. 重新压缩内容，然后将文件扩展名改回 `.xlsx`。
   5. 在 Excel 中打开工作表，然后刷新所有 Report Builder 请求。
* **与输入过滤器或输出范围关联的 Excel 单元格可能已删除**：Report Builder 使用 Excel 名称来将数据请求附加到单元格。如果您从 Names Manager 中删除了 Excel 名称，则会看到此错误。删除 Excel 名称之后就无法恢复请求。如果安排了工作表，您可从 Scheduling Manager 中下载副本，或者打开以前传递的工作表副本。
